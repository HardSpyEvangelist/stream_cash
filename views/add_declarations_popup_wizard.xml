<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="view_add_declarations_popup_wizard_form" model="ir.ui.view">
        <field name="name">add_declarations_popup.wizard.form</field>
        <field name="model">add_declarations_popup.wizard</field>
        <field name="arch" type="xml">
            <form string="Add Declaration">
                <sheet>
                    <group>
                        <group>
                            <field name="declaration_type_ids" force_save="1"/>
                            <field name="declaration_type" invisible="1"/>
                        </group>
                        <group>
                            <field name="currency_id" options="{'no_create': True, 'no_open': True}"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Declaration lines"  >
                             <field name="line_ids" nolabel="1">
                                <list editable="bottom" delete="false" >
                                    <field name="partner_id" width="80px"  force_save="1" column_invisible ="parent.declaration_type not in ['Credit Note','Accounts']"/>
                                    <field name="transaction_type_id" width="120px" force_save="1" 
                                            column_invisible="parent.declaration_type in ('Accounts', 'Credit Note', 'Cash')"
                                            domain="[('declaration_type_id', '=', parent.declaration_type_ids)]"
                                            options="{'no_create': True, 'no_open': True}"/>
                                    <field name="denomination_id" force_save="1" readonly="1"  column_invisible="1"/>
                                    <field name="denomination_name" width="80px"  force_save="1" readonly="1"  column_invisible ="parent.declaration_type != 'Cash'"/>
                                    <field name="denomination_value"  force_save="1" readonly="1" column_invisible ="parent.declaration_type != 'Cash'"/>
                                    <field name="count" force_save="1"  column_invisible ="parent.declaration_type != 'Cash'"/>
                                    <field name="currency_id"  force_save="1" column_invisible="1"/>
                                    <field name="currency_usd"  force_save="1" column_invisible="1"/>
                                    <field name="amount" readonly="parent.declaration_type == 'Cash'" force_save="1" options="{'currency_field': 'currency_id'}" sum="total"/>
                                    <field name="exchange_rate"  force_save="1" readonly="1"/>
                                    <field name="amount_usd" readonly="1"  force_save="1" options="{'currency_field': 'currency_usd'} " sum="total"/>
                                </list>
                            </field>
                        </page>


                    </notebook>
                </sheet>
                <footer>
                    <button string="Save" name="action_save" type="object" class="btn-primary"/>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <record id="action_open_aadd_declarations_popup_wizard" model="ir.actions.act_window">
        <field name="name">Add Declaration</field>
        <field name="res_model">add_declarations_popup.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>
</odoo>